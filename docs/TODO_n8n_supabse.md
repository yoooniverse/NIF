# 📅 2025년 12월 29일 TODO 리스트

**오늘의 목표:** 뉴스 해설 시스템 완성 (사용자 맞춤형 뉴스 경험 제공)

**전체 진행 상황:** Week 3 / 95% 진행 중 (경제순환기 지도 n8n 워크플로우 완성)
**오늘 집중:** 경제순환기 지도 데이터 연동 검증 및 UI 최적화 완료

---

## 🎯 **우선순위 1: 맞춤형 뉴스 해설 시스템 구축** (오늘 완료 목표)

### **필수 작업**

- [x] **뉴스 목록 태그 필터링 로직 구현**
  - [x] #주식, #사업가 등 컨텍스트 태그가 뉴스 목록에 표시되지 않도록 수정 (API 레벨에서 Sanitization 완료)
  - [x] 태그 필터링 함수 개발 및 적용
- [x] **관심분야 기반 뉴스 필터링 시스템 구축**
  - [x] 사용자 관심분야 데이터와 뉴스 카테고리 매핑 (Supabase Interest 기반 필터링 적용)
  - [x] 필터링 로직 구현 및 테스트 (Today/Monthly News API 모두 적용 완료)
- [ ] **맞춤형 뉴스 해설 시스템 개발**
  - [x] 사용자의 관심분야, 레벨, 상황에 맞는 해설 생성 (API 로직 수정: 사용자 Context 우선 매칭)
  - [ ] n8n 워크플로우 최적화 및 테스트

### **쉽게 이해하는 뉴스 해설 시스템** ⭐

**📖 비유로 설명:** 뉴스를 "맞춤 식단"이라고 생각해보세요!

**1단계: 사용자 프로필 분석** (맞춤 데이터 수집)

- **관심분야**: 사용자가 온보딩 때 선택한 분야들
- **레벨**: 초보자/중급자/전문가 레벨에 따른 설명 깊이
- **상황**: 현재 경제 상황과 연관된 맥락

**2단계: 뉴스 필터링 및 태그 정리**

- 관심분야 뉴스만 선별해서 보여주기
- #주식, #사업가 같은 부적절한 태그 제거
- 사용자 레벨에 맞는 뉴스 우선순위 설정

**3단계: 맞춤형 해설 생성**

- 초보자: 쉽게 풀어 설명 + 기초 용어 정리
- 중급자: 전문 용어 사용 + 실무적 시사점
- 전문가: 심층 분석 + 전략적 제언

---

## 🔄 **우선순위 2: 신호등 색상 로직 구현** (병행 진행)

### **진행 중인 작업**

- [ ] **`lib/cycle/determine-status.ts` 파일 생성**
- [ ] **경제 지표 기반 점수 계산 함수 구현**
- [ ] **Red/Yellow/Green 신호등 색상 결정 로직**
- [ ] **입력값 검증 및 에러 핸들링**

---

## 📋 **오늘의 체크리스트**

### **아침: 준비 작업 (9:00 - 10:00)**

- [x] 어제 작업 내용 리뷰 (FRED API credential 적용 완료)
- [x] 오늘 목표 및 우선순위 재확인 ✅ 완료
- [x] 개발 환경 점검 (n8n, Supabase 연결) ✅ 완료
- [x] **오전 디버깅 작업 완료** (오늘의 뉴스, 이달의 뉴스 페이지 데이터 불러오기 문제 해결, 뉴스 필터링, 온보딩, 상세페이지 연동 해결)

### **오전: 뉴스 해설 시스템 구축 (10:00 - 12:00)**

- [x] 뉴스 태그 필터링 로직 구현 (#주식, #사업가 태그 제거) - API 레벨 처리 완료
- [x] 관심분야 기반 뉴스 필터링 시스템 개발 - Interest 기반 Strict Filtering 적용
- [x] 맞춤형 해설 워크플로우 설계 및 구현 완료 (RSS 최적화 진행 중)

### **점심: 테스트 및 검증 (12:00 - 13:00)**

- [ ] 기본 기능 테스트
- [ ] 엣지 케이스 검증

### **오후: 완성 및 통합 (13:00 - 15:00)**

- [ ] 뉴스 필터링 시스템 테스트
- [ ] 맞춤형 해설 기능 검증
- [ ] n8n 워크플로우 최적화 적용
- [ ] **병행: 신호등 로직 개발**
  - [ ] determine-status.ts 기본 구조 구현
  - [ ] 점수 계산 로직 개발

### **오후 후반: DB 및 워크플로우 업데이트 (15:00 - 16:30)**

📋 **작업 순서**
✅ **올바른 순서**
1️⃣ **Supabase SQL 먼저 실행**

- 테이블 구조 변경
- 5분 소요

2️⃣ **n8n 워크플로우 수정**

- 변경된 테이블에 맞게 수정
- 20분 소요

3️⃣ **n8n 테스트**

- 실제로 데이터가 제대로 저장되는지 확인
- 10분 소요

4️⃣ **antigravity에게 요청**

- DB 구조 + 쿼리 로직 + 요구사항 전달

### **저녁: 정리 및 다음 계획 (15:00 - 16:00)**

- [ ] 오늘 작업 내용 정리
- [ ] 내일(12/30) 작업 계획 수립
- [ ] 발견된 이슈 기록

---

## 🎯 **오늘의 성공 기준**

- [x] FRED API credential 보안 적용 완료
- [x] 뉴스 필터링 및 온보딩 시스템 디버깅 완료 - 오늘의/이달의 뉴스 페이지 데이터 불러오기 문제 해결 (2025.12.29 오전)
- [x] **뉴스 해설 시스템 완성**:
  - [x] 뉴스 목록 태그 필터링 (#주식, #사업가 태그 제거)
  - [x] 관심분야 기반 뉴스 필터링 구현
  - [ ] 맞춤형 뉴스 해설 시스템 구축 (n8n 워크플로우 최적화)
- [x] `determineStatusColor()` 함수 완성 (완료)
- [x] 신호등 로직 테스트 및 구현 (완료)
- [x] n8n 워크플로우와 연동 준비 완료 (API 구축)
- [x] 경제 순환기 지도 100% 완성 (실제 데이터 연동 및 n8n 워크플로우 완료)
- [ ] (추후) 경제 순환기 분석 프롬프트 고도화 (데이터 품질 향상 및 표현 고도화)

---

## 📞 **필요시 연락처**

- **기술 지원:** AI 어시스턴트 (이 문서 기반)
- **문제 발생 시:** 오류 로그 확인 후 재시도

---

## 💡 **팁**

- **작게 시작하기:** 뉴스 태그 필터링부터 시작해서 점진적으로 확장
- **사용자 중심:** 항상 사용자의 관심분야와 레벨을 고려한 해설 생성
- **테스트 주도 개발:** 실제 뉴스로 테스트하며 개선 반복
- **입력 데이터 품질이 핵심:** AI가 아무리 좋아도 좋은 데이터가 들어와야 좋은 결과가 나옴
- **RSS 피드 전문화:** 일반 경제 뉴스 대신 관심분야별 전문 RSS 사용

**화이팅! 오늘도 성공적인 하루 되세요! 🚀**

---

# 📝 경제 뉴스 해설 n8n 워크플로우 디버깅 일지

---

## 🎯 프로젝트 목표

**경제 뉴스 자동 해설 시스템 구축**

- RSS에서 경제 뉴스 수집
- AI가 5개 관심분야(주식, 부동산, ETF, 환율, 가상화폐)별 해설 생성
- 6개 상황(직장인, 대출보유, 예적금, 달러보유, 사업가, 해외여행)별 최악 시나리오/행동 조언 제공
- Supabase DB 저장 → Next.js 웹사이트 표시

---

## 🔴 초기 문제

### 증상

- 뉴스 페이지에 빈 데이터만 표시됨
- DB에 title, content가 모두 빈 문자열(`""`)로 저장됨
- `easy_worst_all`, `easy_action_all` 등 모든 필드가 빈 값

---

## 🔍 1단계: 관심분야 필터링 노드 개선

### 문제

- 한글 프롬프트로 AI가 제대로 판단 못함
- 관심분야 기준이 불명확

### 시도한 해결책

**프롬프트를 영어로 변경하고 구체적 분류 기준 추가**

```
기존: 한글 프롬프트

변경:
You are a financial news classifier.
Determine if this news is related to ANY of the following categories.

Categories: 주식, 부동산, ETF, 환율, 가상화폐

Classification Rules:
- Stock (주식): Company earnings, stock market, IPO, corporate news, technology companies
- Real Estate (부동산): Housing market, property prices, mortgage rates, construction
- ETF: Index funds, investment funds, asset management
- Exchange Rate (환율): Currency, USD/KRW, forex, international trade
- Crypto (가상화폐): Bitcoin, Ethereum, blockchain, digital currency
```

### 결과

- ✅ 관심분야 판단은 개선됨
- ❌ 여전히 빈 데이터 생성됨

---

## 🔍 2단계: 해설 가공 노드 개선

### 문제 #1: Structured Output Parser3

**빈 문자열 예시가 AI 출력에 영향**

```json
// 기존 스키마 (문제)
{
  "title": "",  // ← AI가 이 예시대로 빈 값 생성
  "content": "",
  "worst_all": {
    "직장인": "",
    ...
  }
}
```

### 시도한 해결책 #1

**빈 문자열 예시 → 실제 예시로 변경**

```json
{
  "title": "simple title",
  "content": "simple content",
  "worst_all": {
    "직장인": "text here",
    ...
  }
}
```

### 결과

- ❌ 여전히 빈 데이터 생성됨

---

### 문제 #2: AI 프롬프트가 너무 복잡

**형식 오류 발생: "Model output doesn't fit required format"**

### 시도한 해결책 #2

**프롬프트 간소화 + Auto-fix 기능 켜기**

```
간소화된 프롬프트:
Analyze this news for the category: {{ $json.interest_name }}

If NOT related: Return ONLY { "skip": true }
If related: Create analysis with 6 contexts
NO empty strings. NO markdown.
```

**Structured Output Parser3:**

- Auto-Fix Format: ON ✅

### 결과

- ❌ 여전히 빈 데이터 생성됨

---

## 💡 3단계: 근본 원인 발견!

### 해설 가공2 OUTPUT 확인

```json
{
  "skip": true,  // ← 이게 문제!
  "interests": ["부동산"],
  "level1": {
    "title": "",
    "content": "",
    "worst_all": {
      "직장인": "",
      ...
    }
  }
}
```

### 원인 파악

**뉴스:** "LG AI연구원 K-엑사원 성능 공개"  
**관심분야:** 부동산

→ **AI 판단:** "부동산과 관련 없음" → `skip: true` 반환 ✅ (정상)

**핵심 깨달음:**

- AI는 제대로 작동하고 있었음
- 관련 없는 뉴스 → `skip: true` 반환 (정상)
- 관련 있는 뉴스 → 해설 생성 (정상)
- **진짜 문제: `skip: true`인 빈 데이터를 DB에 저장하고 있었음!**

---

## ✅ 4단계: IF 노드 추가 (skip 필터링)

### 해결책

**해설 가공2 → IF (skip != true) → Create a row1**

### IF 노드 조건

```
{{ $json.output.skip }} is not equal to true
```

**Options:**

- Convert types where required: ✅ ON

### 효과

- `skip: true` (관련 없음) → 버림 ✅
- `skip: false` (해설 생성됨) → DB 저장 ✅

---

## 🔴 5단계: RSS 데이터 부족 문제

### 문제 발견

**원래 상황: 매일경제 경제 섹션 전체 RSS만 사용**

- RSS 주소: `https://www.mk.co.kr/rss/30100041/`
- **한 개의 RSS 피드에서 모든 경제 뉴스 수집**
- 정부 정책, 기업 뉴스, 산업 뉴스 위주
- 투자 관련 뉴스 (주식, 부동산, 환율 등) 비중 낮음

**테스트 결과: Limit 25개로 테스트 → 관련 뉴스 여전히 적음**

- **5개 관심분야 매칭률 10-20%만** ❌
- 대부분의 뉴스가 관심분야와 무관
- AI가 `skip: true`를 반환하는 경우가 많음

### 핵심 문제점

**"한 개의 경제 전체 RSS로는 관심분야별 뉴스를 충분히 확보할 수 없음"**

- 경제 뉴스는 광범위하지만 투자 관련 뉴스는 특정 섹션에 집중됨
- 매일경제 경제 섹션만으로는 5개 관심분야를 모두 커버하기 부족

---

## 💡 6단계: RSS 피드 다각화

### 해결책: 관심분야별 RSS 피드 사용

**"매일경제 경제 섹션 하나" → "관심분야별 전문 RSS 여러 개"**

**전략 변경:**

- ❌ **기존:** 한 개의 경제 전체 RSS에서 모든 뉴스 수집
- ✅ **변경:** 관심분야별로 전문 RSS 피드를 각각 가져오기

**카테고리별 전문 RSS 사용**

### 추가할 RSS

```
주식/ETF: https://www.mk.co.kr/rss/30200011/
부동산: https://www.mk.co.kr/rss/30300018/
환율: https://www.mk.co.kr/rss/30800044/
가상화폐: https://www.coindeskkorea.com/news/feed/
```

### 워크플로우 구조 변경

```
뉴스발행
  ├→ 상황 가져오기 → 상황 Aggregate ──┐
  └→ 관심분야 가져오기 → 관심분야 Aggregate ─┘
                              ↓
                    관심분야/상황 merge
                              ↓
        ┌──────────┬──────┴──────┬──────────┐
  뉴스추출-주식  뉴스추출-부동산  뉴스추출-환율  뉴스추출-가상화폐
        └──────────┴──────┬──────┴──────────┘
                        Merge (1개)
                          ↓
                     테스트리밋
```

---

## 🔴 7단계: RSS 접근 오류 문제

### 문제 #1: 코인데스크 코리아

**브라우저 확인:** RSS 피드 없음, 광고만 표시  
**해결:** 블록미디어로 대체 `https://www.blockmedia.co.kr/feed`

### 문제 #2: 매일경제 주식 RSS

**에러:** `Unable to parse XML`  
**브라우저 확인:** 검은 화면, XML 없음  
**원인:** n8n 서버에서 접근 차단 또는 RSS 서비스 중단

### 시도한 해결책들

#### 1. User-Agent 헤더 추가

```
Name: User-Agent
Value: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36
```

**결과:** ❌ 여전히 에러

#### 2. 대체 RSS 시도

```
한국경제 - 증권: https://www.hankyung.com/feed/market
연합뉴스 - 경제: https://www.yonhapnews.co.kr/rss/economy.xml
머니투데이 - 증권: https://news.mt.co.kr/newsrss/section.xml?sec_cd=8
파이낸셜뉴스 - 환율: https://www.fnnews.com/rss/r20_economy_01.xml
```

**결과:** ❌ 모두 접근 불가 또는 SSL 에러

---

## ✅ 8단계: 현실적 해결책 (최종)

### 작동하는 RSS만 사용

```
✅ 부동산: https://www.mk.co.kr/rss/30300018/ (부동산 전문 RSS)
✅ 가상화폐: https://www.blockmedia.co.kr/feed (가상화폐 전문 사이트)
❌ 주식/ETF: 비활성화 (나중에 해결)
❌ 환율: 비활성화 (나중에 해결)
```

### 전략적 의미

**"완벽한 시스템" → "작동하는 최소 시스템"으로 우선 전환**

- 2개의 관심분야(부동산, 가상화폐)라도 제대로 된 뉴스 확보
- 나머지 관심분야(주식, ETF, 환율)는 추후 개선
- 시스템 전체가 작동하는 것이 중요

### 뒤 노드 수정 필요 여부 확인

**확인 결과: 수정 불필요!**

- 관심분야 필터링, Code in JavaScript2, 해설 가공 노드는 RSS 개수와 무관
- 관심분야 5개는 DB에서 가져옴
- 단지 주식/환율 뉴스가 덜 들어올 뿐

---

## 🔧 9단계: HTML 파싱 문제 해결

### 문제

**Code in JavaScript3 노드가 매일경제 전용 파싱 코드**

```javascript
// 매일경제 전용
const titleMatch = html.match(/<h2[^>]*id=\"lgaik[^\"]*\"[^>]*>(.*?)<\\/h2>/);
const contentStart = html.indexOf('pimg.mk.co.kr/news/cms');
```

→ **블록미디어 뉴스는 파싱 안 됨!**

### 해결책

**사이트별 조건부 파싱 코드**

```javascript
const url = $("Limit1").item.json.link || "";

// 매일경제
if (url.includes("mk.co.kr")) {
  // 매일경제 전용 파싱
}
// 블록미디어
else if (url.includes("blockmedia.co.kr")) {
  // 블록미디어 전용 파싱
}
// 기타
else {
  // Extract 결과 사용
}
```

---

## 📊 최종 워크플로우 구조

```
뉴스발행 (매일 8시)
  ├→ 상황 가져오기 (DB) → 상황 Aggregate
  └→ 관심분야 가져오기 (DB) → 관심분야 Aggregate
                                    ↓
                          관심분야/상황 merge
                                    ↓
                    ┌───────────────┴───────────────┐
              뉴스추출-부동산              뉴스추출-가상화폐
                    └───────────────┬───────────────┘
                                 Merge
                                    ↓
                              테스트리밋 (25개)
                                    ↓
                           관심분야 필터링 (AI)
                                    ↓
                            IF (is_category != "True")
                                    ↓
                           뉴스 데이터 정리2
                                    ↓
                          Filter (어제 이후 뉴스)
                                    ↓
                                 Limit1
                                    ↓
                         Extract (본문 크롤링)
                                    ↓
                         Markdown (HTML 변환)
                                    ↓
                             Edit Fields
                                    ↓
                      Code in JavaScript3 (사이트별 파싱)
                                    ↓
                           원문뉴스저장2 (DB)
                                    ↓
                      Code in JavaScript2 (5개 복제)
                                    ↓
                           Limit(테스트용) (25개)
                                    ↓
                            해설 가공 (AI)
                                    ↓
                          IF1 (skip != true)
                                    ↓
                            Create a row1 (DB)
```

---

## 🎯 핵심 학습

### 1. AI 디버깅 방법론

- ❌ 처음 생각: "프롬프트가 나쁘다", "AI가 제대로 작동 안 한다"
- ✅ 실제 문제: "품질 관리 부재"
- **항상 OUTPUT을 확인하라!**

### 2. Structured Output Parser의 역할

- **AI Agent:** "무엇을 쓸지" 지시 (작업 지침, 규칙)
- **Structured Output Parser:** "어떻게 구조화할지" 정의 (JSON 스키마)
- **예시의 중요성:** 빈 예시 → 빈 출력 / 실제 예시 → 실제 내용

### 3. 데이터 품질 관리

- AI는 정상 작동해도 쓰레기 데이터 생성 가능
- **IF 노드 = 품질 검사원** 역할 필수
- `skip` 플래그로 불필요한 데이터 필터링

### 4. RSS 피드 선택의 중요성

- **범용 RSS vs 전문 RSS의 매칭률 차이**
- **한 개의 경제 전체 RSS로는 부족 → 관심분야별 전문 RSS 필요**
- 카테고리별 전문 RSS가 효율적
- 단, 접근 제한/차단 문제 존재

### 5. 웹 크롤링의 현실

- 각 언론사마다 HTML 구조가 다름
- 사이트별 전용 파싱 코드 필요
- RSS 차단 시 대체 방안 준비 필요

---

## 📌 남은 과제

### 단기

- [ ] 블록미디어 HTML 파싱 코드 실제 구조로 수정
- [ ] 전체 워크플로우 테스트 실행
- [ ] DB에 정상 해설 저장 확인

### 중장기

- [ ] 주식/ETF RSS 대체 방안 찾기
- [ ] 환율 RSS 대체 방안 찾기
- [ ] HTTP Request 노드로 직접 크롤링 구현 검토

---

## 🏆 성과

1. ✅ 워크플로우 구조 완성
2. ✅ AI 프롬프트 최적화
3. ✅ 품질 관리 시스템 구축 (IF 노드)
4. ✅ 다중 RSS 통합 구조 구현
5. ✅ 사이트별 조건부 파싱 구현

---

## 📝 교훈

**"문제는 AI가 아니라 데이터 흐름이었다"**

- 프롬프트 개선만으로는 부족
- 데이터 검증 및 필터링이 핵심
- 실제 OUTPUT 확인이 가장 중요
- RSS 피드 선택이 전체 시스템 품질에 영향

**"완벽보다 작동이 우선"**

- 5개 관심분야 중 2개만 작동해도 시스템은 돌아감
- 한 개의 경제 전체 RSS → 관심분야별 전문 RSS로 전략 변경
- 나중에 점진적으로 개선 가능
- 우선 완성하고 개선하는 방식

---

_작성일: 2025.12.31_  
_최종 수정: 2025.12.31_

- DB에 title, content가 모두 빈 문자열(`""`)로 저장됨

---

### 🔍 1단계: 관심분야 필터링 노드 개선

**문제**

- 한글 프롬프트로 AI가 제대로 판단 못함
- 관심분야 기준이 불명확

**시도한 해결책**

```
기존: 한글 프롬프트
변경: 영어 프롬프트 + 구체적 분류 기준 추가
```

**예시:**

- Stock (주식): Company earnings, IPO, tech companies
- Real Estate (부동산): Housing, property prices
- 등등...

**결과**
✅ 관심분야 판단은 개선됨
❌ 여전히 빈 데이터 생성됨

---

### 🔍 2단계: 해설 가공2 노드 개선

**문제 #1: Structured Output Parser3**

- 스키마에 빈 문자열 예시가 있음

```json
{
  "title": "", // ← AI가 이걸 따라함!
  "content": ""
}
```

**시도한 해결책 #1**

```
빈 문자열 예시 → 실제 예시로 변경
```

**결과**
❌ 여전히 빈 데이터 생성됨

---

**문제 #2: 프롬프트가 너무 복잡**

- AI가 혼란스러워서 형식 오류 발생
- "Model output doesn't fit required format" 에러

**시도한 해결책 #2**

```
프롬프트 간소화
Auto-fix 기능 켜기
```

**결과**
❌ 여전히 빈 데이터 생성됨

---

### 🔍 3단계: 근본 원인 발견!

**해설 가공2 OUTPUT 확인**

```json
{
  "skip": true,  // ← 이게 문제!
  "interests": ["부동산"],
  "level1": {
    "title": "",
    "content": "",
    ...
  }
}
```

**원인 파악**
**뉴스:** "LG AI연구원 K-엑사원 성능 공개"
**관심분야:** 부동산

→ **AI 판단:** "부동산과 관련 없음" → `skip: true` 반환 ✅

**이건 정상 작동입니다!**

---

### 💡 핵심 깨달음

**문제는 프롬프트가 아니었다!**

AI는 제대로 작동하고 있었음:

- 관련 없는 뉴스 → `skip: true` 반환 (정상)
- 관련 있는 뉴스 → 해설 생성 (정상)

**진짜 문제:**

```
skip: true인 빈 데이터를 DB에 저장하고 있었음! ❌
```

---

### ✅ 최종 해결책

**워크플로우 수정**

**Before:**

```
해설 가공2 → Create a row1
            ↓
          DB에 모든 데이터 저장 (skip:true 포함) ❌
```

**After:**

```
해설 가공2 → IF (skip != true) → Create a row1
            ↓                    ↓
          skip:true           skip:false만
          (버림)              DB 저장 ✅
```

**IF 노드 조건**

```
{{ $json.output.skip }} is not equal to true
```

**의미:**

- `skip: false` (해설 생성됨) → DB 저장 ✅
- `skip: true` (관련 없음) → 버림 ✅

---

### 🎯 결론

**처음 생각한 문제**

1. 프롬프트가 나쁘다
2. AI가 제대로 작동 안 한다
3. 스키마가 잘못됐다

**실제 문제**
**품질 관리 부재!**

AI는 제대로 작동했지만, `skip: true`인 쓰레기 데이터를 걸러내지 않고 DB에 저장하고 있었음.

### 해결

**IF 노드 = 품질 검사원**
"해설 제대로 생성됐어? 안 됐으면 DB에 넣지 마!"

---

### 📌 교훈

**디버깅 순서:**

1. ❌ 프롬프트 수정 (필요했지만 근본 원인 아님)
2. ❌ 스키마 수정 (필요했지만 근본 원인 아님)
3. ✅ **데이터 흐름 확인** → 진짜 문제 발견!

**항상 OUTPUT을 확인하라!** 🚀

---

## 📋 **현재 상황 정리** (2025.12.30)

### 🎯 원래 목표

**경제 뉴스 자동 해설 시스템**

- 5개 관심분야 (주식, 부동산, ETF, 환율, 가상화폐)
- 각 뉴스마다 AI 해설 생성
- DB 저장 → 웹사이트 표시

---

### ✅ 완료한 것들

1. **워크플로우 구조** ✅
2. **관심분야 필터링 노드** ✅
3. **해설 생성 노드** ✅
4. **IF 노드 추가** (skip 필터링) ✅
5. **5개 복제 로직** ✅
6. **DB 저장** ✅

---

### 🔴 발견한 문제

#### 테스트 실행 결과

**Limit 1개로 테스트:**

```json
{
  "title": "부동산 관련 없음",
  "content": "이 뉴스는 LG의 AI 기술...",
  "action_all": {
    "직장인": "해당 없음",
    ...
  }
}
```

→ **AI는 정상 작동** ✅
→ **but, 부동산과 관련 없는 뉴스였음** ❌

---

**Limit 25개로 늘림:**
→ **여전히 관련 뉴스 적음** ❌

---

### 💡 원인 파악

**현재 RSS:**

```
https://www.mk.co.kr/rss/30100041/
(매일경제 - 경제 전체 섹션)
```

**문제:**

- 정부 정책, 기업 뉴스, 산업 뉴스 위주
- 투자 관련 뉴스 (주식, 부동산, 환율 등) 비중 낮음
- **5개 관심분야 매칭률 10-20%만** ❌

---

### 🎯 해결책: RSS 추가

**카테고리별 전문 RSS 사용:**

```
주식 전문 RSS → 매칭률 80-90% ✅
부동산 전문 RSS → 매칭률 90-100% ✅
환율 전문 RSS → 매칭률 80-90% ✅
```

**이유:**

- AI는 정상 작동 중
- 단지 RSS 피드에 관련 뉴스가 없었을 뿐
- **입력 데이터를 바꿔야 함!** ✅

---

### 🚀 다음 단계

**RSS 3-4개 추가:**

1. 증권 (주식+ETF)
2. 부동산
3. 환율
4. (선택) 가상화폐

→ **관련 뉴스 많아짐** ✅
→ **AI 해설 제대로 생성됨** ✅

---

### 📌 핵심 교훈

**문제는 AI가 아니라 데이터!**

좋은 식재료(RSS) 넣어야 → 좋은 요리(해설) 나옴! 🍳

**디버깅의 3단계:**

1. **코드/프롬프트 문제?** → 수정
2. **데이터 흐름 문제?** → 확인
3. **입력 데이터 품질?** → **바꾸기** ← 현재 단계

---

## 🔴 경제 순환기 지도 (Economic Radar) 표시 이슈 (2026.01.02)

### 증상
- 경제 순환기 지도 페이지(/cycle)가 정상적으로 표시되지 않음.
- "Initializing Economic Radar System..." 메시지만 표시되거나 데이터가 비어 있음.
- 터미널 로그: `[CYCLE_API] No cycle data found in table cycle_explanations`, `GET /api/cycle/current 404`.

### 원인
- **데이터 부재:** `cycle_explanations` 테이블이 완전히 비어 있음.
- **API 로직:** `/api/cycle/current` API는 데이터가 없을 경우 404 에러를 반환함.
- **워크플로우 미완료:** 경제 순환기 데이터를 채워주는 n8n 워크플로우가 아직 개발/테스트 중이라 실제 데이터가 DB에 쌓이지 않음.
- **Mock 데이터 제거:** 초기 개발 시 사용하던 Mock 데이터 로직이 실제 DB 연동 로직으로 대체되면서 데이터가 없는 상황이 노출됨.

### 해결 방안
- **단기:** Supabase SQL Editor를 통해 샘플 데이터를 수동으로 삽입하여 UI 연동 확인.
- **장기:** n8n 경제 순환기 워크플로우(FRED API 연동)를 완성하여 매일 자동으로 데이터를 적재하도록 구현.

